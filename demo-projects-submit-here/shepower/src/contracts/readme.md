
# 《ShePower: Genesis》Web3 技术与智能合约详解

## 1. 概述：技术如何实现愿景

《ShePower: Genesis》的“Play-to-Impact”核心理念，是通过两份专门设计的智能合约来实现的。这两份合约共同构建了一个去中心化、透明且安全的经济和资产系统，将玩家在游戏中的努力与现实世界的影响力直接关联。

本文档将详细解释这两份最终版合约的设计哲学与工作流程。

## 2. 核心组件一：$SHE 代币合约 (`SheToken.sol`)

`$SHE`代币是游戏的经济基石和治理凭证。它的合约设计严格遵循了“去中心化”和“可预测性”的核心原则。

#### 核心设计与实现：

* **固定且透明的总量**：合约中设定了**10亿枚**的绝对最大供应量。这个数字被定义为代码中的一个“常量”，意味着它在合约部署后**永远无法被修改**。这从根本上杜绝了未来超发的可能性，保证了`$SHE`的稀缺性和长期价值。

* **部署即分配 (Fair Launch)**：与可以持续增发的代币不同，`$SHE`合约的所有10亿枚代币，都在**合约被部署到区块链的那一刻被全部铸造**。这些代币会按照预设的分配方案，自动发送到不同的专用地址中（如：社区奖励池、项目金库、团队锁仓合约等）。

* **去中心化的代币管理**：完成“部署即分配”后，这份代币合约**没有任何“所有者”或管理员权限**。这意味着没有任何单一实体可以事后增发或操纵代币的供给。未来游戏中玩家获得的`$SHE`奖励，都将从“社区奖励池”这个地址中转出，而不是新铸造出来的，保证了整个经济系统的公平和透明。

## 3. 核心组件二：角色NFT合约 (`CharacterNFT.sol`)

角色NFT是玩家在游戏中最具代表性的个人资产，它代表了玩家对一个角色的永久所有权。其合约设计在保证去中心化所有权的同时，也兼顾了游戏运营的实际需求。

#### 核心设计与实现：

* **中心化的铸造控制**：与`$SHE`代币合约不同，NFT合约被设计为拥有一个**“所有者”（Owner）**角色，这个角色将由**游戏官方的服务器钱包**来担任。只有这个“所有者”地址才有权铸造（`mint`）新的角色NFT。这是至关重要的设计，它确保了NFT只能作为玩家在游戏中达成特定成就（如完成章节）后的奖励，而不能被随意创造。

* **自动化且唯一的ID生成**：合约内部使用了一个安全的计数器。每当一个新的NFT被铸造时，合约会自动为其分配一个独一无二的、从0开始递增的ID（如 `0`, `1`, `2`, ...）。这保证了每一枚角色NFT都是独特的。

* **灵活且高效的元数据（URI）方案**：合约本身不存储NFT的图片、名称等具体信息。取而代之的是，它只存储一个指向IPFS（一种去中心化存储网络）上某个文件夹的**基地址（`baseURI`）**。每个NFT的完整元数据地址，是由这个基地址和NFT自身的ID拼接而成（例如：`ipfs://..../1.json`）。
    * **这对游戏的意义**：这种设计完美地支持了“**从模糊变清晰**”的创意。当需要升级NFT的视觉效果时，团队**只需更新IPFS上的图片或JSON文件**，而无需在区块链上进行成本高昂的交易。这为未来的内容更新和玩法迭代提供了巨大的灵活性。

## 4. 两大合约的协同工作流程

1.  **赢得NFT**：玩家在游戏中完成一个关键章节。
    * 游戏服务器确认成就达成。
    * 服务器的钱包（作为NFT合约的`Owner`）调用`CharacterNFT.sol`合约的`mint(玩家地址)`函数。
    * 一枚新的、拥有唯一ID的角色NFT被创建并发送到玩家的钱包中。

2.  **赚取$SHE**：玩家在游戏中积累了足够的“平权值”。
    * 游戏服务器确认奖励条件达成。
    * 服务器触发一笔**普通的转账交易**，从项目的**“社区奖励池”钱包**中，将预定数量的`$SHE`代币发送到玩家钱包。
    * （注意：此过程**没有调用**`SheToken.sol`的铸造函数，因为所有代币早已存在。）

3.  **参与治理**：玩家决定参与一次DAO投票。
    * 玩家将自己的钱包连接到DAO投票平台。
    * 平台自动读取`SheToken.sol`合约，查询该玩家钱包地址中的`$SHE`余额，以此作为其投票权重。
    * 玩家成功投票，将游戏内的努力转化为了对现实世界决策的真实影响。